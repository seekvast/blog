(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[680],{3523:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2898).Z)("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]])},7810:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2898).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},6264:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},2882:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2898).Z)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]])},7472:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let r=(0,s(2898).Z)("MoreHorizontal",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},5807:function(e,t,s){Promise.resolve().then(s.bind(s,7904))},7904:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return v}});var r=s(7437),n=s(2265),a=s(4033),i=s(251),c=s(6264),l=s(3523),d=s(7472),o=s(7810),u=s(2882),f=s(5808),x=s(575),m=s(3277),h=s(4971);function v(){var e;let t=(0,a.useParams)(),[s,v]=(0,n.useState)(!0),[p,g]=(0,n.useState)(null),[j,y]=(0,n.useState)([]),[N,b]=(0,n.useState)(!0),[w,k]=(0,n.useState)(1),[z,_]=(0,n.useState)(1),[E,S]=(0,n.useState)([]),[C,Z]=(0,n.useState)(null),{t:A}=(0,i.$G)();(0,n.useEffect)(()=>{t.slug&&T()},[t.slug]),(0,n.useEffect)(()=>{(null==p?void 0:p.id)&&R()},[null==p?void 0:p.id]),(0,n.useEffect)(()=>{(null==p?void 0:p.id)&&F()},[null==p?void 0:p.id,C]);let T=async()=>{try{v(!0);let e=await h.d.get("/api/board?slug=".concat(t.slug));0===e.code&&g(e.data)}catch(e){console.error("Failed to fetch board detail:",e)}finally{v(!1)}},F=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;try{if(b(!0),!(null==p?void 0:p.id))return;let t=await h.d.get("/api/discussions?board_id=".concat(p.id,"&page=").concat(e,"&per_page=10&board_child_id=").concat(C||""));0===t.code&&(y(s=>1===e?t.data.items:[...s,...t.data.items]),k(t.data.current_page),_(t.data.last_page))}catch(e){console.error("Failed to fetch discussions:",e)}finally{b(!1)}},R=async()=>{try{if(!(null==p?void 0:p.id))return;let e=await h.d.get("/api/board/children?board_id=".concat(p.id));0===e.code&&S(e.data.items)}catch(e){console.error("Failed to fetch board children:",e)}};return s?(0,r.jsx)("div",{className:"flex h-[calc(100vh-60px)] items-center justify-center",children:(0,r.jsx)(c.Z,{className:"h-8 w-8 animate-spin text-primary"})}):p?(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("div",{className:"bg-white",children:(0,r.jsx)("div",{className:"mx-auto w-full px-8",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3 pb-4",children:[(0,r.jsxs)(f.qE,{className:"h-12 w-12 rounded-lg",children:[(0,r.jsx)(f.F$,{src:p.avatar,alt:p.name}),(0,r.jsx)(f.Q5,{children:p.name[0]})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("h1",{className:"text-lg font-medium",children:p.name}),1===p.is_nsfw&&(0,r.jsx)(m.C,{variant:"secondary",className:"bg-red-50 text-red-600",children:"成人"})]}),(0,r.jsxs)(x.z,{variant:"outline",size:"sm",className:"space-x-1",children:["已加入",(0,r.jsx)(l.Z,{className:"h-4 w-4"})]})]}),(0,r.jsxs)("div",{className:"mt-1 text-sm text-muted-foreground",children:[1===p.visibility?"私密":"公开"," \xb7"," ",null===(e=p.category)||void 0===e?void 0:e.name]}),(0,r.jsx)("div",{className:"mt-1 text-sm text-muted-foreground",children:p.desc})]})]})})}),(0,r.jsx)("div",{className:"bg-white",children:(0,r.jsxs)("div",{className:"mx-auto w-full px-8",children:[(0,r.jsxs)("div",{className:"flex h-[60px] items-center justify-between border-b border-[#EAEAEA]",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-8",children:[(0,r.jsx)(x.z,{variant:"ghost",className:"h-8 px-1 font-medium text-primary hover:bg-transparent hover:text-primary",children:"文章"}),(0,r.jsx)(x.z,{variant:"ghost",className:"h-8 px-1 font-medium text-muted-foreground hover:bg-transparent hover:text-foreground",children:"规则"}),(0,r.jsx)(x.z,{variant:"ghost",className:"h-8 px-1 font-medium text-muted-foreground hover:bg-transparent hover:text-foreground",children:"子版"}),(0,r.jsx)(x.z,{variant:"ghost",className:"h-8 px-1 font-medium text-muted-foreground hover:bg-transparent hover:text-foreground",children:"讨论"})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(x.z,{variant:"ghost",size:"sm",className:"h-8 space-x-2 text-muted-foreground hover:bg-transparent hover:text-foreground",children:["热门",(0,r.jsx)(l.Z,{className:"h-4 w-4"})]}),(0,r.jsx)(x.z,{variant:"ghost",size:"sm",className:"h-8 space-x-2 text-muted-foreground hover:bg-transparent hover:text-foreground",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"lucide lucide-list",children:[(0,r.jsx)("line",{x1:"8",x2:"21",y1:"6",y2:"6"}),(0,r.jsx)("line",{x1:"8",x2:"21",y1:"12",y2:"12"}),(0,r.jsx)("line",{x1:"8",x2:"21",y1:"18",y2:"18"}),(0,r.jsx)("line",{x1:"3",x2:"3.01",y1:"6",y2:"6"}),(0,r.jsx)("line",{x1:"3",x2:"3.01",y1:"12",y2:"12"}),(0,r.jsx)("line",{x1:"3",x2:"3.01",y1:"18",y2:"18"})]})})]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4 py-3 text-sm",children:[(0,r.jsx)(x.z,{variant:C?"ghost":"default",size:"sm",className:"rounded-full ".concat(C?"text-muted-foreground":"text-white"),onClick:()=>Z(null),children:"全部"}),E.map(e=>(0,r.jsx)(x.z,{variant:C===e.id?"default":"ghost",size:"sm",className:"rounded-full ".concat(C===e.id?"text-white":"text-muted-foreground"),onClick:()=>Z(e.id),children:e.name},e.id))]})]})}),(0,r.jsxs)("div",{className:"mx-auto w-full px-8",children:[(0,r.jsx)("div",{className:"space-y-4 py-4",children:N?(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(c.Z,{className:"h-8 w-8 animate-spin text-primary"})}):0===j.length?(0,r.jsx)("div",{className:"flex justify-center py-8 text-muted-foreground",children:"這裡空空如也"}):j.map(e=>(0,r.jsx)("div",{className:"py-4",children:(0,r.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,r.jsxs)(f.qE,{className:"h-10 w-10 rounded-lg",children:[(0,r.jsx)(f.F$,{src:e.user.avatar_url}),(0,r.jsx)(f.Q5,{children:e.user.username[0]})]}),(0,r.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,r.jsx)("div",{className:"mb-1",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)("span",{className:"font-medium",children:e.title}),1===e.is_private&&(0,r.jsx)(m.C,{variant:"secondary",children:"私密"}),1===e.is_sticky&&(0,r.jsx)(m.C,{variant:"secondary",className:"bg-blue-50 text-blue-600",children:"置顶"})]}),(0,r.jsx)(x.z,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,r.jsx)(d.Z,{className:"h-4 w-4"})})]})}),(0,r.jsx)("div",{children:(0,r.jsx)("p",{className:"mt-1 text-md text-muted-foreground line-clamp-2",children:e.main_post.content})}),(0,r.jsxs)("div",{className:"mt-3 flex items-center space-x-4 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-muted-foreground",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.votes})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-muted-foreground",children:[(0,r.jsx)(u.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{children:e.comment_count})]}),(0,r.jsx)("div",{className:"flex items-center space-x-1 text-muted-foreground",children:(0,r.jsx)("span",{children:e.diff_humans})}),(0,r.jsxs)("div",{className:"flex items-center space-x-1 text-muted-foreground",children:[(0,r.jsxs)("span",{children:["来自 ",e.board.name]})," ",(0,r.jsxs)("span",{children:["#",e.board_child.name]})]})]})]})]})},e.first_post_id))}),!N&&w<z&&(0,r.jsx)("div",{className:"flex justify-center py-8",children:(0,r.jsx)(x.z,{variant:"outline",onClick:()=>{w<z&&F(w+1)},className:"w-[200px]",children:"加載更多"})})]})]}):(0,r.jsx)("div",{className:"flex h-[calc(100vh-60px)] items-center justify-center",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:"看板不存在"})})}},5808:function(e,t,s){"use strict";s.d(t,{F$:function(){return l},Q5:function(){return d},qE:function(){return c}});var r=s(7437),n=s(2265),a=s(6694),i=s(2169);let c=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(a.fC,{ref:t,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",s),...n})});c.displayName=a.fC.displayName;let l=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(a.Ee,{ref:t,className:(0,i.cn)("aspect-square h-full w-full",s),...n})});l.displayName=a.Ee.displayName;let d=n.forwardRef((e,t)=>{let{className:s,...n}=e;return(0,r.jsx)(a.NY,{ref:t,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",s),...n})});d.displayName=a.NY.displayName},3277:function(e,t,s){"use strict";s.d(t,{C:function(){return c}});var r=s(7437);s(2265);var n=s(6061),a=s(2169);let i=(0,n.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function c(e){let{className:t,variant:s,...n}=e;return(0,r.jsx)("div",{className:(0,a.cn)(i({variant:s}),t),...n})}},575:function(e,t,s){"use strict";s.d(t,{z:function(){return d}});var r=s(7437),n=s(2265),a=s(7256),i=s(6061),c=s(2169);let l=(0,i.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:s,variant:n,size:i,asChild:d=!1,...o}=e,u=d?a.g7:"button";return(0,r.jsx)(u,{className:(0,c.cn)(l({variant:n,size:i,className:s})),ref:t,...o})});d.displayName="Button"},4971:function(e,t,s){"use strict";s.d(t,{d:function(){return i}});var r=s(2749);class n extends Error{constructor(e,t,s){super(e),this.status=t,this.code=s,this.name="RequestError"}}async function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{auth:s=!0,raw:a=!1,...i}=t,c=e.startsWith("http")?e:"".concat("http://106.55.228.122:8200").concat(e);if(s){let e=await (0,r.getSession)();(null==e?void 0:e.accessToken)&&(i.headers={...i.headers,Authorization:"Bearer ".concat(e.accessToken)})}i.headers={Accept:"application/json",...!(i.body instanceof FormData)&&{"Content-Type":"application/json"},...i.headers};try{let e=await fetch(c,i);if(a)return e;let t=await e.json();if(t.code>0)throw new n("string"==typeof t.message?t.message:JSON.stringify(t.message),e.status,t.code);if(!e.ok)throw new n(t.message||e.statusText,e.status,t.code);if(401===t.code)throw await (0,r.signOut)({redirect:!0}),new n("登录已过期，请重新登录",401);return t}catch(e){if(e instanceof n)throw e;throw new n(e.message)}}let i={get:async(e,t)=>a(e,{method:"GET",...t}),async post(e,t,s){let r={},n=JSON.stringify(t);return t instanceof FormData?n=t:r["Content-Type"]="application/json",a(e,{method:"POST",body:n,headers:r,...s})},put:async(e,t,s)=>a(e,{method:"PUT",body:JSON.stringify(t),...s}),delete:async(e,t)=>a(e,{method:"DELETE",...t})}},2169:function(e,t,s){"use strict";s.d(t,{cn:function(){return a}});var r=s(7042),n=s(4769);function a(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,n.m6)((0,r.W)(t))}},4033:function(e,t,s){e.exports=s(5313)},6694:function(e,t,s){"use strict";s.d(t,{Ee:function(){return y},NY:function(){return N},fC:function(){return j}});var r=s(2265),n=s(6989),a=s(6459),i=s(5655),c=s(9381),l=s(7437),d="Avatar",[o,u]=(0,n.b)(d),[f,x]=o(d),m=r.forwardRef((e,t)=>{let{__scopeAvatar:s,...n}=e,[a,i]=r.useState("idle");return(0,l.jsx)(f,{scope:s,imageLoadingStatus:a,onImageLoadingStatusChange:i,children:(0,l.jsx)(c.WV.span,{...n,ref:t})})});m.displayName=d;var h="AvatarImage",v=r.forwardRef((e,t)=>{let{__scopeAvatar:s,src:n,onLoadingStatusChange:d=()=>{},...o}=e,u=x(h,s),f=function(e,t){let[s,n]=r.useState("idle");return(0,i.b)(()=>{if(!e){n("error");return}let s=!0,r=new window.Image,a=e=>()=>{s&&n(e)};return n("loading"),r.onload=a("loaded"),r.onerror=a("error"),r.src=e,t&&(r.referrerPolicy=t),()=>{s=!1}},[e,t]),s}(n,o.referrerPolicy),m=(0,a.W)(e=>{d(e),u.onImageLoadingStatusChange(e)});return(0,i.b)(()=>{"idle"!==f&&m(f)},[f,m]),"loaded"===f?(0,l.jsx)(c.WV.img,{...o,ref:t,src:n}):null});v.displayName=h;var p="AvatarFallback",g=r.forwardRef((e,t)=>{let{__scopeAvatar:s,delayMs:n,...a}=e,i=x(p,s),[d,o]=r.useState(void 0===n);return r.useEffect(()=>{if(void 0!==n){let e=window.setTimeout(()=>o(!0),n);return()=>window.clearTimeout(e)}},[n]),d&&"loaded"!==i.imageLoadingStatus?(0,l.jsx)(c.WV.span,{...a,ref:t}):null});g.displayName=p;var j=m,y=v,N=g}},function(e){e.O(0,[461,749,646,971,938,744],function(){return e(e.s=5807)}),_N_E=e.O()}]);