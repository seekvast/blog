exports.id=880,exports.ids=[880],exports.modules={64173:(e,s,r)=>{Promise.resolve().then(r.bind(r,12327))},12327:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>M});var t=r(95344),a=r(3729),l=r(22254),i=r(49517),n=r(9758),c=r(20783),o=r.n(c),d=r(66198),x=r(5094),h=r(14871),m=r(11453),u=r(47674),j=r(39769),p=r(32175),v=r(46540),f=r(7361);let g=a.forwardRef(({className:e,...s},r)=>t.jsx("textarea",{className:(0,m.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:r,...s}));g.displayName="Textarea";var N=r(38157),b=r(63099),w=r(25173);function y({open:e,onOpenChange:s}){let{data:r}=(0,u.useSession)(),{toast:l}=(0,j.pm)(),[i,n]=(0,a.useState)(!1),[c,o]=(0,a.useState)({name:"",slug:"",desc:"",visibility:0,category_id:1,is_nsfw:0}),d=(e,s)=>{o(r=>({...r,[e]:s}))},h=async e=>{try{let s=new FormData;for(let r of(s.append("image",e),s.append("attachment_type","board_avatars"),console.log("File object:",e),console.log("FormData entries:"),s.entries()))console.log(r[0],r[1]);let r=await w.d.post("/api/upload/image",s);if(0===r.code){let e=`${r.data.host}${r.data.file_path}`;return o(s=>({...s,attachment_id:r.data.id,avatar:e})),e}throw Error(r.message||"Upload failed")}catch(e){return console.error("Failed to upload image:",e),l({title:"上传失败",description:e instanceof Error?e.message:"图片上传失败，请重试",variant:"destructive"}),null}},m=async()=>{if(!r?.accessToken){l({variant:"destructive",title:"未登录",description:"请先登录后再创建看板"});return}if(!c.name.trim()){l({variant:"destructive",title:"请输入看板名称"});return}if(!c.slug.trim()){l({variant:"destructive",title:"请输入看板网址"});return}try{n(!0),await w.d.post("/api/board",c),l({title:"创建成功",description:"看板创建成功"}),s(!1)}catch(e){l({variant:"destructive",title:"创建失败",description:e.message||"看板创建失败，请重试"})}finally{n(!1)}};return t.jsx(p.Vq,{open:e,onOpenChange:s,children:(0,t.jsxs)(p.cZ,{className:"max-w-[480px]",children:[t.jsx(p.fK,{children:t.jsx(p.$N,{className:"text-xl font-semibold",children:"建立看板"})}),(0,t.jsxs)("div",{className:"space-y-6 py-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板頭像"}),(0,t.jsxs)("div",{className:"relative",children:[t.jsx("input",{type:"file",className:"hidden",id:"boardImage",accept:"image/jpeg,image/jpg,image/png,image/gif",onChange:e=>h(e.target.files?.[0])}),t.jsx("label",{htmlFor:"boardImage",className:"w-24 h-24 rounded-full bg-neutral-100 flex items-center justify-center cursor-pointer hover:bg-neutral-200 transition-colors",children:c.avatar?t.jsx("img",{src:c.avatar,alt:"Board avatar",className:"w-full h-full rounded-full object-cover"}):t.jsx(b.Z,{className:"w-8 h-8 text-neutral-400"})})]}),t.jsx("div",{className:"text-sm text-neutral-500",children:"照片上傳規格要求：格式為JPG、JPEG、GIF或者png，大小 2MB以內。"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板名稱"}),t.jsx(v.I,{placeholder:"最長15個中文字或相同長度英文字",maxLength:15,value:c.name,onChange:e=>d("name",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板網址"}),t.jsx(v.I,{placeholder:"https://kater.me/community/xxx",value:c.slug,onChange:e=>d("slug",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板簡介"}),t.jsx(g,{placeholder:"請輸入看板簡介",className:"resize-none",rows:4,value:c.desc,onChange:e=>d("desc",e.target.value)})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板被搜尋"}),(0,t.jsxs)(N.Ph,{value:String(c.visibility),onValueChange:e=>d("visibility",Number(e)),children:[t.jsx(N.i4,{children:t.jsx(N.ki,{placeholder:"選擇公開範圍"})}),(0,t.jsxs)(N.Bw,{children:[t.jsx(N.Ql,{value:"0",children:"公開"}),t.jsx(N.Ql,{value:"1",children:"私密"})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"看板類型"}),(0,t.jsxs)(N.Ph,{value:String(c.category_id),onValueChange:e=>d("category_id",Number(e)),children:[t.jsx(N.i4,{children:t.jsx(N.ki,{placeholder:"選擇看板類型"})}),(0,t.jsxs)(N.Bw,{children:[t.jsx(N.Ql,{value:"1",children:"綜合"}),t.jsx(N.Ql,{value:"2",children:"科技"}),t.jsx(N.Ql,{value:"3",children:"生活"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(f._,{children:"討論類型"}),(0,t.jsxs)(N.Ph,{value:String(c.is_nsfw),onValueChange:e=>d("is_nsfw",Number(e)),children:[t.jsx(N.i4,{children:t.jsx(N.ki,{placeholder:"選擇討論類型"})}),(0,t.jsxs)(N.Bw,{children:[t.jsx(N.Ql,{value:"0",children:"一般討論"}),t.jsx(N.Ql,{value:"1",children:"成人内容"})]})]})]})]})]}),t.jsx(x.z,{className:"w-full bg-blue-600 text-white hover:bg-blue-700",onClick:m,disabled:i,children:i?"创建中...":"建立看板"}),(0,t.jsxs)("div",{className:"text-center text-sm text-neutral-500",children:["建立看板的同時，代表您已同意《",t.jsx("a",{href:"#",className:"text-blue-600 hover:underline",children:"內容政策"}),"》"]})]})})}let k=[{title:"首頁",href:"/",icon:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-primary",children:[t.jsx("path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"}),t.jsx("polyline",{points:"9 22 9 12 15 12 15 22"})]})},{title:"關注",href:"/",icon:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"})})},{title:"看板",href:"/boards",icon:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("circle",{cx:"12",cy:"12",r:"10"}),t.jsx("path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20"}),t.jsx("path",{d:"M2 12h20"})]})},{title:"書籤",href:"/",icon:t.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:t.jsx("path",{d:"M19 21l-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z"})})}];function C({className:e,...s}){let r=(0,l.usePathname)(),{t:i,i18n:c}=(0,n.$G)(),[u,j]=(0,a.useState)(!1);return t.jsx("aside",{className:(0,m.cn)("flex w-full flex-col gap-4 h-full",e),...s,children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 pr-4",children:[t.jsx("nav",{className:"flex flex-col gap-1",children:k.map(e=>{let s=r===e.href;return(0,t.jsxs)(o(),{href:e.href,className:(0,m.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-neutral-500 transition-colors","hover:bg-neutral-100 hover:text-neutral-900",s&&"bg-neutral-100 text-neutral-900"),children:[e.icon,t.jsx("span",{children:e.title})]},e.href)})}),t.jsx(x.z,{className:"my-4 w-full",size:"lg",onClick:()=>j(!0),children:i(r.startsWith("/boards")?"common.createBoard":"common.createDiscussion")}),t.jsx(y,{open:u,onOpenChange:j}),(0,t.jsxs)("div",{className:"my-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 mb-2",children:[t.jsx("h3",{className:"text-sm font-medium",children:"推薦看板"}),t.jsx(x.z,{variant:"ghost",size:"icon",className:"h-6 w-6",children:(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"}),t.jsx("path",{d:"M21 3v5h-5"}),t.jsx("path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"}),t.jsx("path",{d:"M8 16H3v5"})]})})]}),t.jsx("div",{className:"border-y py-3 space-y-1",children:[{name:"FTTT",members:1,letter:"F"},{name:"NSFW",members:12922,letter:"N",tag:"成人"},{name:"TFF11",members:1,letter:"T"}].map(e=>(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg px-2 py-2 hover:bg-accent",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[t.jsx(h.qE,{className:"h-8 w-8",children:t.jsx(h.Q5,{children:e.letter})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(o(),{href:`/boards/${e.name}`,className:"text-sm font-medium",children:e.name}),e.tag&&t.jsx("span",{className:"rounded bg-red-500 px-1 py-0.5 text-[10px] text-white",children:e.tag})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[(0,t.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[t.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),t.jsx("circle",{cx:"9",cy:"7",r:"4"}),t.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),t.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),t.jsx("span",{children:e.members})]})]})]}),t.jsx(x.z,{size:"sm",className:"rounded-full",children:"加入"})]},e.name))})]}),(0,t.jsxs)("div",{className:"mt-auto space-y-4",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm text-muted-foreground",children:[t.jsx(o(),{href:"#",className:"hover:text-foreground",children:i("common.termsOfService")}),t.jsx(o(),{href:"#",className:"hover:text-foreground",children:i("common.privacyPolicy")}),t.jsx(o(),{href:"#",className:"hover:text-foreground",children:i("common.contactUs")}),t.jsx(o(),{href:"#",className:"hover:text-foreground",children:i("common.helpCenter")})]}),t.jsx("div",{className:"flex items-center text-sm text-muted-foreground",children:(0,t.jsxs)("div",{role:"button",onClick:()=>{let e=c.language;c.changeLanguage("zh-TW"===e?"en":"zh-TW")},className:"flex items-center gap-2 hover:text-foreground",children:[t.jsx(d.Z,{className:"ml-auto h-4 w-4"}),t.jsx("span",{children:i("common.autoDetectLanguage")})]})})]})]})})}var _=r(41223),L=r.n(_);function z({className:e,...s}){let{data:r}=(0,u.useSession)();return(0,t.jsxs)("aside",{className:(0,m.cn)("sticky top-14 flex-shrink-0",e),...s,children:[(0,t.jsxs)("div",{className:"",children:[t.jsx("h3",{className:"text-sm font-medium pb-2 px-2 border-b",children:"精品专题"}),(0,t.jsxs)("div",{className:" space-y-2 py-2 px-2",children:[t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"发点色图"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"老司机的操作"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"XXX交流"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"小阿喵思考lsajbsan爱上"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"阿喵思考会聊妳聊妳聊阿森纳说"})]}),t.jsx(x.z,{variant:"outline",size:"sm",className:"my-2 w-full",children:"更多专题"})]}),(0,t.jsxs)("div",{className:"",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between py-2 px-2 border-b",children:[t.jsx("h3",{className:"text-sm font-medium",children:"相关文章"}),t.jsx(x.z,{variant:"ghost",size:"sm",className:"h-auto p-0 text-xs font-normal text-muted-foreground hover:text-foreground",children:"换一换"})]}),(0,t.jsxs)("div",{className:"space-y-2 py-2 px-2",children:[t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"最近翻译了，大家要小心不要"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"预览救命啊！公司服务器升级"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"北美性价比最高的杜甫"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"预览刚遇到一个怪事"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"不懂就问：美国商务部禁止"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"那扇局面已经控制不住了，"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"T楼送碑名"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"煮了7個新米,新玩具"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"「郭家軍」被禁黑"}),t.jsx(o(),{href:"#",className:"block text-sm hover:text-primary",children:"敏感羅莉娘性感精油按摩"})]})]}),t.jsx("div",{className:"relative aspect-[3/4] w-full overflow-hidden",children:t.jsx(L(),{src:"/ad.jpg",alt:"Advertisement",fill:!0,className:"object-cover"})})]})}function M({children:e}){let s=!(0,l.usePathname)().startsWith("/boards");return(0,t.jsxs)("div",{className:"min-h-screen",children:[t.jsx(i.h,{}),t.jsx("div",{className:"mx-auto flex justify-center pt-8",children:(0,t.jsxs)("div",{className:"w-[1360px] flex justify-between px-4 relative",children:[t.jsx("div",{className:"sticky top-[88px] min-w-[300px] h-[calc(100vh-88px)]",children:t.jsx(C,{className:"hidden lg:block"})}),t.jsx("main",{className:"w-full",children:e}),s&&t.jsx(z,{className:"hidden lg:block mt-8"})]})})]})}},84968:(e,s,r)=>{"use strict";r.r(s),r.d(s,{$$typeof:()=>l,__esModule:()=>a,default:()=>i});let t=(0,r(86843).createProxy)(String.raw`/var/www/forum-system-temp/src/app/(main)/layout.tsx`),{__esModule:a,$$typeof:l}=t,i=t.default}};